<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Model Viewer â€“ Grab, Scale & Rotate</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
Â  margin: 0;
Â  overflow: hidden;
Â  background: #000;
Â  font-family: -apple-system, system-ui;
Â  color: #00ffcc;
}
canvas { display:block; }

/* Instruction box (top right) */
#instructions {
Â  position: fixed;
Â  top: 20px;
Â  right: 20px;
Â  background: rgba(0,0,0,0.85);
Â  padding: 14px 16px;
Â  border-radius: 12px;
Â  border: 1px solid #333;
Â  font-size: 12px;
Â  line-height: 1.5;
Â  z-index: 10;
}

/* Status box */
#ui {
Â  position: fixed;
Â  top: 20px;
Â  left: 20px;
Â  background: rgba(0,0,0,0.85);
Â  padding: 14px;
Â  border-radius: 12px;
Â  border: 1px solid #333;
Â  font-size: 12px;
Â  z-index: 10;
}

/* Loading */
#loading {
Â  position: fixed;
Â  inset: 0;
Â  background: black;
Â  display: flex;
Â  align-items: center;
Â  justify-content: center;
Â  z-index: 100;
}
.spinner {
Â  width: 40px;
Â  height: 40px;
Â  border: 4px solid #333;
Â  border-top: 4px solid #00ffcc;
Â  border-radius: 50%;
Â  animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Webcam preview */
#v-prev {
Â  position: fixed;
Â  bottom: 20px;
Â  right: 20px;
Â  width: 140px;
Â  opacity: 0.4;
Â  border: 1px solid #00ffcc;
Â  border-radius: 8px;
Â  transform: scaleX(-1);
}

/* Hand dots */
.hand-dot {
Â  position: fixed;
Â  width: 14px;
Â  height: 14px;
Â  border-radius: 50%;
Â  background: #00ffcc;
Â  box-shadow: 0 0 12px #00ffcc;
Â  pointer-events: none;
Â  transform: translate(-50%, -50%);
Â  display: none;
Â  z-index: 50;
}
</style>
</head>

<body>

<div id="loading"><div class="spinner"></div></div>

<div id="ui">
Â  <b>Status</b><br>
Â  <span id="debug">Waiting for handsâ€¦</span>
</div>

<div id="instructions">
Â  <b>Controls</b><br>
Â  ğŸ¤ Pinch + move = grab<br>
Â  ğŸ¤ğŸ¤ Two-hand pinch = rotate<br>
Â  âœ‹ Spread hands = scale
</div>

<video id="webcam" autoplay playsinline style="display:none"></video>
<video id="v-prev" autoplay playsinline></video>

<div id="dotL" class="hand-dot"></div>
<div id="dotR" class="hand-dot"></div>

<script type="importmap">
{
Â  "imports": {
Â  Â  "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
Â  Â  "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
Â  }
}
</script>

<script type="module">
import * as THREE from "three";
import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";
import { HandLandmarker, FilesetResolver }
Â  from "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.7";

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ THREE SETUP â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setPixelRatio(devicePixelRatio);
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

const camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(0, 0, 80);

scene.add(new THREE.DirectionalLight(0xffffff, 2).position.set(10,20,20));
scene.add(new THREE.AmbientLight(0xffffff, 0.6));

const grid = new THREE.GridHelper(200, 20, 0x00ffcc, 0x222222);
grid.position.y = -25;
scene.add(grid);

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ MODEL â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

let model;
let baseScale = 1;
let targetScale = 1;
let smoothScale = 1;

new GLTFLoader().load("model.glb", gltf => {
Â  model = gltf.scene;

Â  const box = new THREE.Box3().setFromObject(model);
Â  const size = box.getSize(new THREE.Vector3()).length();
Â  baseScale = 30 / size;

Â  model.scale.setScalar(baseScale);
Â  box.getCenter(model.position).multiplyScalar(-1);

Â  scene.add(model);
Â  document.getElementById("loading").style.display = "none";
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ HAND TRACKING â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

const video = document.getElementById("webcam");
const dotL = document.getElementById("dotL");
const dotR = document.getElementById("dotR");

let handLandmarker;
let baselineDist = null;
let grabbing = false;
let lastMid = null;
let lastAngle = null;

async function initHands() {
Â  const vision = await FilesetResolver.forVisionTasks(
Â  Â  "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.7/wasm"
Â  );

Â  handLandmarker = await HandLandmarker.createFromOptions(vision, {
Â  Â  baseOptions: {
Â  Â  Â  modelAssetPath:
Â  Â  Â  Â  "https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task"
Â  Â  },
Â  Â  runningMode: "VIDEO",
Â  Â  numHands: 2
Â  });

Â  const stream = await navigator.mediaDevices.getUserMedia({ video:true });
Â  video.srcObject = document.getElementById("v-prev").srcObject = stream;

Â  video.onloadeddata = () => {
Â  Â  trackHands();
Â  Â  animate();
Â  };
}

function pinch(hand) {
Â  const i = hand[8], t = hand[4];
Â  return Math.hypot(i.x - t.x, i.y - t.y) < 0.04;
}

function updateDot(dot, lm) {
Â  dot.style.left = `${lm.x * innerWidth}px`;
Â  dot.style.top Â = `${lm.y * innerHeight}px`;
Â  dot.style.display = "block";
}

function trackHands() {
Â  const res = handLandmarker.detectForVideo(video, performance.now());

Â  if (res.landmarks?.length) {
Â  Â  const hands = res.landmarks;
Â  Â  const pinches = hands.map(pinch);

Â  Â  if (hands.length === 2) {
Â  Â  Â  const a = hands[0][8];
Â  Â  Â  const b = hands[1][8];

Â  Â  Â  updateDot(dotL, a);
Â  Â  Â  updateDot(dotR, b);

Â  Â  Â  const d = Math.hypot(a.x - b.x, a.y - b.y);
Â  Â  Â  if (!baselineDist) baselineDist = d;
Â  Â  Â  targetScale = baseScale * THREE.MathUtils.clamp(d / baselineDist, 0.4, 3);

Â  Â  Â  if (pinches[0] && pinches[1]) {
Â  Â  Â  Â  const mid = { x:(a.x+b.x)/2, y:(a.y+b.y)/2 };
Â  Â  Â  Â  const angle = Math.atan2(b.y-a.y, b.x-a.x);

Â  Â  Â  Â  if (lastAngle !== null) {
Â  Â  Â  Â  Â  model.rotation.y += angle - lastAngle;
Â  Â  Â  Â  }
Â  Â  Â  Â  lastAngle = angle;
Â  Â  Â  Â  document.getElementById("debug").innerText = "Rotating";
Â  Â  Â  } else {
Â  Â  Â  Â  lastAngle = null;
Â  Â  Â  }
Â  Â  } else if (hands.length === 1 && pinches[0]) {
Â  Â  Â  const p = hands[0][8];
Â  Â  Â  updateDot(dotL, p);
Â  Â  Â  dotR.style.display = "none";

Â  Â  Â  if (!lastMid) lastMid = p;
Â  Â  Â  model.position.x += (p.x - lastMid.x) * 50;
Â  Â  Â  model.position.y -= (p.y - lastMid.y) * 50;
Â  Â  Â  lastMid = p;

Â  Â  Â  document.getElementById("debug").innerText = "Grabbing";
Â  Â  } else {
Â  Â  Â  dotL.style.display = dotR.style.display = "none";
Â  Â  Â  baselineDist = lastMid = lastAngle = null;
Â  Â  Â  document.getElementById("debug").innerText = "Show hands";
Â  Â  }
Â  }

Â  requestAnimationFrame(trackHands);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ RENDER LOOP â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

function animate() {
Â  smoothScale += (targetScale - smoothScale) * 0.15;
Â  if (model) model.scale.setScalar(smoothScale);

Â  renderer.render(scene, camera);
Â  requestAnimationFrame(animate);
}

initHands();

addEventListener("resize", ()=>{
Â  renderer.setSize(innerWidth, innerHeight);
Â  camera.aspect = innerWidth / innerHeight;
Â  camera.updateProjectionMatrix();
});
</script>
</body>
</html>
Exagerate rotate 
